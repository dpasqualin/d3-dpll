<!DOCTYPE html>
<html>
<head>
	<title>SAT Solver</title>
	<link href="dpll.css" media="all" rel="stylesheet" type="text/css" />
	<script src="jquery-1.10.1.min.js"></script>
	<script src="d3.v3.min.js" charset="utf-8"></script>
	<script src="dpll.js"></script>
</head>
<body>
	<h1>SAT Solver</h1>
	<p>
	Enter a series of clauses (one for each line):
	<p>
	<textarea id="problemTxt" cols="50" rows="10" ></textarea>
	<p>
	<input id="solveBtn" type="submit" value="Solve">
	<p>
	<input id="nextBtn" type="submit" value="Next Step">
	<p>
	<strong>Solution:</strong>
	<p>
	<tt id="solutionTxt"></tt>
	<div id="graph"></div>

	<script src="dpll.js"></script>
	<script src="graph.js"></script>

	<script>

	$(document).ready(function() {
		var varsDict = {}; // Var number -> Var name
        var graph = new Graph('#graph');
        var dpll = new Dpll(graph);
        var $nextBtn = $('#nextBtn');
        var $solveBtn = $('#solveBtn');

        function printResult(objRes) {
            var done = objRes[0],
                sat = objRes[1],
                sol = objRes[2];

            if (done) {
    		    $('#solutionTxt').html(dpll.getPrintableSol(sol, varsDict));
                $nextBtn.prop('disabled', true);
                $solveBtn.prop('disabled', false);
            }
        };

        $('#problemTxt').val('1 2\n-1\n-2');

        $solveBtn.click(function() {
    		var formula = dpll.getClauses($('#problemTxt').val(), varsDict); // Fills var dict
    		$('#problemTxt').val(dpll.getPrintableClauses(formula, varsDict));
    		var objRes = dpll.solve(formula, {}, {'step_by_step': true});
            $nextBtn.prop('disabled', false);
            $solveBtn.prop('disabled', true);
            printResult(objRes);
        });

        $nextBtn.prop('disabled', true);
        $nextBtn.click(function() {
            printResult(dpll.nextStep());
        });

	});

	</script>

</body>
</html>
